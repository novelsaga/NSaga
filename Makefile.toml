[config]
  default_to_workspace = false
  skip_core_tasks      = true

  # ==================== DEPRECATED ====================
  # This Makefile.toml is now just a thin wrapper around xtask.
  # You can use `cargo xtask` directly for all build tasks.
  # Run `cargo xtask --help` to see all available commands.
  # =====================================================

[tasks.wasm]
  args    = ["xtask", "wasm"]
  command = "cargo"

[tasks.so]
  script = '''
if [ -n "${SO_TARGET:-}" ]; then
    cargo xtask so --target "$SO_TARGET"
else
    cargo xtask so
fi
'''
  script_runner = "@shell"

[tasks.so-all]
  args    = ["xtask", "so-all"]
  command = "cargo"

[tasks.cli]
  script = '''
if [ -n "${CLI_TARGET:-}" ]; then
    cargo xtask cli --target "$CLI_TARGET"
else
    cargo xtask cli
fi
'''
  script_runner = "@shell"

[tasks.cli-all]
  args    = ["xtask", "cli-all"]
  command = "cargo"

[tasks.build-all]
  args    = ["xtask", "build-all"]
  command = "cargo"

[tasks.gen-ts-bindings]
  args    = ["xtask", "gen-ts-bindings"]
  command = "cargo"

[tasks.clean-wasm]
  args    = ["xtask", "clean-wasm"]
  command = "cargo"

[tasks.clean-so]
  args    = ["xtask", "clean-so"]
  command = "cargo"

[tasks.clean-cli]
  args    = ["xtask", "clean-cli"]
  command = "cargo"

[tasks.clean-all]
  args    = ["xtask", "clean-all"]
  command = "cargo"

[tasks.default]
  script = '''
echo "üìã NovelSaga Build Tasks (now using xtask)"
echo ""
echo "‚ö†Ô∏è  Note: This Makefile.toml is deprecated. Use 'cargo xtask' directly."
echo ""
echo "Available commands:"
echo "  cargo xtask wasm                    - Build WASM package"
echo "  cargo xtask so [--target TARGET]    - Build Shared Library"
echo "  cargo xtask so-all                  - Build SO for all platforms"
echo "  cargo xtask cli [--target TARGET]   - Build CLI binary"
echo "  cargo xtask cli-all                 - Build CLI for all platforms"
echo "  cargo xtask build-all               - Build everything"
echo "  cargo xtask gen-ts-bindings         - Generate TypeScript bindings"
echo "  cargo xtask clean-all               - Clean all artifacts"
echo ""
echo "  cargo xtask --help                  - Show all available commands"
echo ""
echo "Targets: macos-arm64, macos-x64, windows-arm64, windows-x64,"
echo "         linux-arm64, linux-x64, android-arm64 (SO only)"
echo ""
'''
