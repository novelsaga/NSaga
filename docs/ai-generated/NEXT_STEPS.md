# NovelSaga CLI - ä¸‹ä¸€æ­¥å·¥ä½œè®¡åˆ’

**æ›´æ–°æ—¶é—´**: 2026-02-02
**å½“å‰çŠ¶æ€**: âœ… P0 æ„å»ºéªŒè¯å®Œæˆ + Nix æ„å»ºæ”¯æŒå®Œæˆ + æ„å»ºç³»ç»Ÿé‡æ„å®Œæˆ

---

## ğŸ“Š å½“å‰è¿›åº¦æ€»è§ˆ

### âœ… å·²å®Œæˆçš„æ ¸å¿ƒåŠŸèƒ½

#### Stage 4: Bridge Manager (2026-01-26 å®Œæˆ)
- âœ… JSON-RPC 2.0 é€šä¿¡å±‚ï¼ˆTransport + RPC Clientï¼‰
- âœ… è¿è¡Œæ—¶ç®¡ç†ï¼ˆNode.js/Bun/Deno å‘ç°å’Œè¿›ç¨‹ç®¡ç†ï¼‰
- âœ… Bridge ç®¡ç†å™¨ï¼ˆæ‡’åŠ è½½ã€é‡è¯•ã€çº¿ç¨‹å®‰å…¨ï¼‰
- âœ… ConfigBridge å®ç°ï¼ˆé€šè¿‡ Bridge åŠ è½½ JS/TS é…ç½®ï¼‰
- âœ… å†…å­˜å®‰å…¨é‡æ„ï¼ˆ`Arc<Mutex<Box<dyn Bridge>>>` æ¶æ„ï¼‰

#### Stage 5: Config Loader (2026-01-26 å®Œæˆ)
- âœ… ConfigLoader å®ç°ï¼ˆé…ç½®æŸ¥æ‰¾å’ŒåŠ è½½ï¼‰
- âœ… CLI é›†æˆï¼ˆjs_loader/ts_loader é—­åŒ…ï¼‰
- âœ… E2E æµ‹è¯•æ¡†æ¶ï¼ˆxtask test moduleï¼‰
- âœ… å¤šæ ¼å¼æ”¯æŒï¼ˆ.mjs/.ts/.cjsï¼‰

#### P1.1: ä»£ç è´¨é‡æ”¹è¿› (2026-01-26 å®Œæˆ)
- âœ… **å¸¸é‡å¤ç”¨**ï¼šæ¶ˆé™¤ç¡¬ç¼–ç ï¼Œç»Ÿä¸€ä½¿ç”¨ core çš„å¸¸é‡å®šä¹‰
  - æ–‡ä»¶æ‰©å±•åï¼š`CONFIG_FILE_NAMES`, `NovelSagaFileFormat::get_extensions()`
  - ç¯å¢ƒå˜é‡ï¼š`env_keys::*` æ¨¡å—ï¼ˆRust + JS åŒç«¯åŒæ­¥ï¼‰
- âœ… **E2E æµ‹è¯•æ‰©å±•**ï¼šä» 5 ä¸ªæµ‹è¯•æ‰©å±•åˆ° 14 ä¸ª
  - 3 ä¸ªè¿è¡Œæ—¶ Ã— 4 ç§é…ç½®æ ¼å¼ = 12 ä¸ªçŸ©é˜µæµ‹è¯•
  - 2 ä¸ªåŸºç¡€æµ‹è¯•ï¼ˆé…ç½®ä¼˜å…ˆçº§ã€é”™è¯¯å¤„ç†ï¼‰
  - æ™ºèƒ½è·³è¿‡æœºåˆ¶ï¼ˆNode.js < 23.6 è·³è¿‡ TS æµ‹è¯•ï¼‰
  - TypeScript æµ‹è¯•ä½¿ç”¨çœŸå®çš„ TS è¯­æ³•ï¼ˆinterfaceã€ç±»å‹æ³¨è§£ï¼‰

**æµ‹è¯•çŠ¶æ€**:
- âœ… å•å…ƒæµ‹è¯•ï¼šBridge Managerã€ConfigBridge
- âœ… é›†æˆæµ‹è¯•ï¼š`test_bridge_manager`
- âœ… E2E æµ‹è¯•ï¼š`./xtask.sh e2e` (14 ä¸ªåœºæ™¯å…¨éƒ¨é€šè¿‡)

---

## ğŸ“ ä»Šå¤©å®Œæˆçš„å·¥ä½œæ€»ç»“ (2026-02-02)

### âœ… P0 - æ„å»ºéªŒè¯ä¸ Nix æ„å»ºæ”¯æŒ (å·²å®Œæˆ)

**Nix æ„å»ºå®Œæ•´æ”¯æŒ**:

#### 1. **xtask æ–°å¢ `--skip-js` å’Œ `--copy-only` å‚æ•°**
- `./xtask.sh cli --skip-js` - è·³è¿‡ JS æ„å»ºï¼Œåªæ„å»º CLI
- `./xtask.sh cli-all --skip-js` - è·³è¿‡ JS æ„å»ºï¼Œåªæ„å»ºæ‰€æœ‰å¹³å° CLI
- `./xtask.sh build-all --skip-js` - è·³è¿‡ JS æ„å»ºï¼Œæ„å»ºæ‰€æœ‰äº§ç‰©
- `./xtask.sh build-js --copy-only` - åªå¤åˆ¶å·²æ„å»ºçš„ assets åˆ° `out/cli/`

**ç”¨é€”**: Nix æ„å»ºä¸­æ‰‹åŠ¨æ„å»º JS åï¼Œå¯ä½¿ç”¨ `--skip-js` é¿å…é‡å¤æ„å»º

#### 2. **Nix Bundle åŒ… (`nix build .#bundle`)**
**ä¾èµ–ç®¡ç†**:
- ä½¿ç”¨ `fetchPnpmDeps` é¢„å– npm ä¾èµ–ï¼ˆéœ€è¦ hashï¼‰
- æ·»åŠ  `pkgs.pnpm`, `pkgs.nodejs`, `pkgs.deno` åˆ° `nativeBuildInputs`
- `pnpmConfigHook` è‡ªåŠ¨å®‰è£…ä¾èµ–åˆ° `node_modules`

**æ„å»ºæµç¨‹**:
1. `pnpmConfigHook` å®‰è£… JS ä¾èµ–ï¼ˆç¦»çº¿ï¼Œä½¿ç”¨é¢„å–çš„ä¾èµ–ï¼‰
2. æ‰‹åŠ¨è¿è¡Œ `node build.mts` æ„å»ºæ¯ä¸ª bridgeï¼ˆé¿å… pnpm è‡ªæˆ‘æ›´æ–°è§¦å‘ç½‘ç»œè¯·æ±‚ï¼‰
   - `bridge-deno/build.mts` è‡ªåŠ¨ç”Ÿæˆ `deno.d.ts`ï¼ˆè°ƒç”¨ `deno types`ï¼‰
3. `cargo run -p xtask --release -- build-all --skip-js` æ„å»ºæ‰€æœ‰ Rust ç›®æ ‡
4. `cargo run -p xtask --release -- build-js --copy-only` å¤åˆ¶ assets åˆ° CLI è¾“å‡º
5. å®‰è£…åˆ° `$out/share/novelsaga/{cli,wasm,so}/`

**äº§ç‰©ç»“æ„**:
```
result/share/novelsaga/
â”œâ”€â”€ cli/
â”‚   â”œâ”€â”€ linux-x64/novelsaga
â”‚   â”œâ”€â”€ macos-arm64/novelsaga
â”‚   â”œâ”€â”€ windows-x64/novelsaga.exe
â”‚   â””â”€â”€ assets/js/dist/
â”‚       â”œâ”€â”€ config-bridge.js
â”‚       â””â”€â”€ package.json
â”œâ”€â”€ wasm/
â”‚   â””â”€â”€ novelsaga_core_bg.wasm
â””â”€â”€ so/
    â”œâ”€â”€ linux-x64/libnovelsaga_core.so
    â””â”€â”€ ...
```

#### 3. **Nix Default åŒ… (`nix build` æˆ– `nix build .#cli`)**
**ç‰¹ç‚¹**: åªæ„å»º CLIï¼Œäº§ç‰©æ›´è½»é‡

**æ„å»ºæµç¨‹**:
1. ä½¿ç”¨ nightly Rust toolchainï¼ˆæ”¯æŒ `#![feature(mpmc_channel)]`ï¼‰
2. `pnpmConfigHook` å®‰è£… JS ä¾èµ–
3. `preBuild`: æ‰‹åŠ¨æ„å»ºæ‰€æœ‰ JS bridges
4. `cargo build` æ„å»º CLIï¼ˆ`buildAndTestSubdir = "projects/cli"`ï¼‰
5. `postInstall`: å¤åˆ¶ JS assets åˆ° `$out/share/novelsaga/assets/js/dist/`

**äº§ç‰©ç»“æ„**:
```
result/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ novelsaga
â””â”€â”€ share/
    â””â”€â”€ novelsaga/
        â””â”€â”€ assets/
            â””â”€â”€ js/
                â””â”€â”€ dist/
                    â”œâ”€â”€ config-bridge.js
                    â””â”€â”€ package.json
```

**éªŒè¯ç»“æœ**:
- âœ… `nix build .#bundle` æˆåŠŸæ„å»ºæ‰€æœ‰å¹³å°äº§ç‰©
- âœ… `nix build` æˆ– `nix build .#cli` æˆåŠŸæ„å»ºå•å¹³å° CLI
- âœ… JS assets æ­£ç¡®å¤åˆ¶åˆ°è¾“å‡ºç›®å½•
- âœ… æ‰€æœ‰æ„å»ºåœ¨ Nix æ²™ç›’ä¸­å®Œæˆï¼ˆæ— ç½‘ç»œè®¿é—®ï¼‰

**pnpmDeps hash æ›´æ–°æµç¨‹**:
```bash
# 1. ä¿®æ”¹ hash ä¸ºå ä½ç¬¦
hash = "sha256-AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=";

# 2. è¿è¡Œæ„å»ºè·å–æ­£ç¡®çš„ hash
nix build .#bundle 2>&1 | grep "got:"

# 3. æ›´æ–° hash åˆ° packages.nix
```

### âœ… P1.2 - æ„å»ºç³»ç»Ÿé‡æ„ (2026-02-02 å®Œæˆ)

**é—®é¢˜**: 5 ä¸ª bridge åŒ…çš„ build.mts å­˜åœ¨å¤§é‡é‡å¤ä»£ç ï¼ˆ50-68 è¡Œç›¸ä¼¼é€»è¾‘ï¼‰

**è§£å†³æ–¹æ¡ˆ**: åˆ›å»ºç»Ÿä¸€çš„æ„å»ºå·¥å…·åŒ… `@nsaga/build-tool`

**å®æ–½å†…å®¹**:
1. **åˆ›å»º build-tool åŒ…** (`projects/cli-js-bridges/build-tool/`):
   - `buildBridge()` å‡½æ•°æä¾›ç»Ÿä¸€æ„å»ºæ¥å£
   - æ”¯æŒé€‰é¡¹ï¼š
     - `name`: åŒ…å
     - `rootDir`: æ ¹ç›®å½•
     - `entryPoints`: å…¥å£æ–‡ä»¶åˆ—è¡¨ï¼ˆæˆ–ä½¿ç”¨ `autoScanSrc`ï¼‰
     - `autoScanSrc`: è‡ªåŠ¨æ‰«æ src ç›®å½•æ‰€æœ‰ .ts æ–‡ä»¶
     - `preBuild`: æ„å»ºå‰é’©å­ï¼ˆå¦‚ Deno types ç”Ÿæˆï¼‰
     - `postBuild`: æ„å»ºåé’©å­ï¼ˆå¦‚åˆ›å»º package.jsonï¼‰
     - `esbuildOverrides`: è‡ªå®šä¹‰ esbuild é…ç½®
     - `generateDts`: æ˜¯å¦ç”Ÿæˆ .d.ts æ–‡ä»¶ï¼ˆé»˜è®¤ trueï¼‰

2. **é‡æ„æ‰€æœ‰ bridge æ„å»ºè„šæœ¬**:
   - **bridge-core** (68 â†’ 7 è¡Œ): ä½¿ç”¨ `autoScanSrc: true`
   - **bridge-nodejs** (58 â†’ 7 è¡Œ): ä½¿ç”¨ `autoScanSrc: true`
   - **bridge-bun** (50 â†’ 11 è¡Œ): æŒ‡å®š `entryPoints`
   - **bridge-deno** (58 â†’ 23 è¡Œ): æŒ‡å®š `entryPoints` + `preBuild` hook
   - **config-bridge** (49 â†’ 27 è¡Œ): `generateDts: false` + è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„

3. **Workspace é…ç½®**:
   - æ·»åŠ  build-tool åˆ°æ‰€æœ‰ bridge çš„ `devDependencies`
   - ä½¿ç”¨åŒ…åå¼•ç”¨ `@nsaga/build-tool` è€Œéç›¸å¯¹è·¯å¾„
   - pnpm workspace è‡ªåŠ¨åŒ…å«ï¼ˆ`projects/cli-js-bridges/*`ï¼‰

**é‡æ„æ•ˆæœ**:
- âœ… æ¶ˆé™¤äº†çº¦ **180 è¡Œé‡å¤ä»£ç **
- âœ… ç»Ÿä¸€çš„æ„å»ºé€»è¾‘ï¼Œæ˜“äºç»´æŠ¤
- âœ… æ”¯æŒçµæ´»çš„æ‰©å±•ï¼ˆhooks + overridesï¼‰
- âœ… æ‰€æœ‰æ„å»ºæµ‹è¯•é€šè¿‡ï¼š`./xtask.sh build-js` âœ…

**ä»£ç ç¤ºä¾‹**:
```typescript
// æ—§ä»£ç ï¼š50+ è¡Œ esbuild é…ç½®å’Œé”™è¯¯å¤„ç†
// æ–°ä»£ç ï¼š
import { buildBridge } from "@nsaga/build-tool";
buildBridge({
  name: "bridge-bun",
  rootDir: __dirname,
  entryPoints: ["src/transport.ts", "src/index.ts"],
});
```

---

## ğŸ“ å†å²å·¥ä½œæ€»ç»“ (2026-02-01)

### âœ… P1.1.3 - Build-All Integration (å·²å®Œæˆ)

**é—®é¢˜åˆ†æ**:
- `build-all` å’Œ `cli-all` åœ¨æ„å»º CLI å‰æœªè‡ªåŠ¨è°ƒç”¨ `build-js`
- `cli::build_all()` å…ˆæ„å»º JS â†’ ç„¶ååˆ é™¤æ•´ä¸ª out/cli ç›®å½• â†’ assets è¢«æ„å¤–åˆ é™¤
- `out/cli/assets/` ç›®å½•ä¸­ç¼ºå°‘ JS bridge äº§ç‰©

**ä¿®å¤å†…å®¹**:
1. **è°ƒç”¨é¡ºåºä¼˜åŒ–**: `cli::build_all()` è°ƒæ•´ä¸ºï¼š
   - å…ˆæ¸…ç† `out/cli/` ç›®å½•
   - å†è°ƒç”¨ `build_all()` æ„å»º JS å¹¶è‡ªåŠ¨å¤åˆ¶ assets
   - æœ€åæ„å»ºå„å¹³å° CLI äºŒè¿›åˆ¶
2. **è‡ªåŠ¨å¤åˆ¶**: `build_all()` æ–°å¢ `copy_assets_to_out()` å‡½æ•°
   - ä» `projects/cli/assets/js/dist/` å¤åˆ¶åˆ° `out/cli/assets/js/dist/`
3. **å•æ¬¡è°ƒç”¨**: `cli-all` ä»»åŠ¡ç¡®ä¿åœ¨å¼€å¤´åªè°ƒç”¨ä¸€æ¬¡ `build-js`
4. **è‡ªåŠ¨è§¦å‘**: `build-single` å’Œ `build-all` éƒ½ä¼šåœ¨æ„å»ºå‰è‡ªåŠ¨è°ƒç”¨ `build-js`

**éªŒè¯ç»“æœ**:
- âœ… `./xtask.sh build-js` æ­£ç¡®å¤åˆ¶ assets åˆ° `out/cli/assets/js/dist/`
- âœ… `out/cli/assets/js/dist/config-bridge.js` å’Œ `package.json` å­˜åœ¨
- âœ… `cli-all` ä»»åŠ¡ä¸ä¼šåˆ é™¤å·²å¤åˆ¶çš„ assets

---

## ğŸ“ å†å²å·¥ä½œæ€»ç»“ (2026-01-27)

### âœ… P1.1.1 - ç”¨æˆ·æŒ‡å®šè¿è¡Œæ—¶è·¯å¾„ (å·²å®Œæˆ)
- CLI å‚æ•°æ”¯æŒï¼š`--runtime`, `--node-path`, `--bun-path`, `--deno-path`
- ConfigLoader é›†æˆ RuntimeDiscovery
- æµ‹è¯•è¦†ç›–ï¼šE2E æµ‹è¯•å…¨éƒ¨é€šè¿‡

### âœ… P1.1.2 - JS Bridge è‡ªåŠ¨æ„å»º (å·²å®Œæˆ)
- xtask build-jsï¼šå¢é‡æ„å»º + mtime æ£€æµ‹
- é›†æˆåˆ° E2E æµ‹è¯•æµç¨‹
- è¾“å‡ºç›®å½•ï¼š`projects/cli/assets/js/dist/`

### âœ… P1.1.3 - Build-All Integration (å·²å®Œæˆ - 2026-02-01)
**ä¿®å¤å†…å®¹**:
1. **è°ƒç”¨é¡ºåºä¼˜åŒ–**: `cli::build_all()` è°ƒæ•´ä¸ºå…ˆæ¸…ç† â†’ æ„å»º JS â†’ æ„å»º CLIï¼ˆé¿å…åˆ é™¤åˆšå¤åˆ¶çš„ assetsï¼‰
2. **è‡ªåŠ¨å¤åˆ¶**: `build_all()` è‡ªåŠ¨å°† JS äº§ç‰©ä» `projects/cli/assets/js/dist/` å¤åˆ¶åˆ° `out/cli/assets/js/dist/`
3. **å•æ¬¡è°ƒç”¨**: `cli-all` ä»»åŠ¡ç¡®ä¿åœ¨å¼€å¤´åªè°ƒç”¨ä¸€æ¬¡ `build-js`
4. **è‡ªåŠ¨è§¦å‘**: `build-single` å’Œ `build-all` éƒ½ä¼šåœ¨æ„å»ºå‰è‡ªåŠ¨è°ƒç”¨ `build-js`

**éªŒè¯ç»“æœ**:
- âœ… `./xtask.sh build-js` æ­£ç¡®å¤åˆ¶ assets åˆ° `out/cli/assets/js/dist/`
- âœ… `./xtask.sh cli-all` ä¸ä¼šåˆ é™¤å·²å¤åˆ¶çš„ assets
- âœ… Assets åœ¨å¼€å‘å’Œç”Ÿäº§ç¯å¢ƒéƒ½èƒ½æ­£ç¡®è¢«æ‰¾åˆ°

### âœ… P1.1.4 - æ¸…ç†åºŸå¼ƒæµ‹è¯• (å·²å®Œæˆ)
- 9 ä¸ªå•å…ƒæµ‹è¯•æ”¹ç”¨ tempfile
- åˆ é™¤ `projects/cli/assets/test/`

### âœ… P1.1.5 - JS æºç ç›®å½•é‡æ„ (å·²å®Œæˆ - æœ€ç»ˆä¿®æ­£)
**æ¶æ„è°ƒæ•´**:
1. **æºç åˆ†ç¦»**: JS æºç ç§»åŠ¨åˆ° `projects/cli-js-bridges/` (åˆ é™¤ `src` ä¸­é—´å±‚ï¼Œä¿æŒç‹¬ç«‹æ€§å’Œæ¸…æ™°åº¦)
2. **äº§ç‰©é›†æˆ**: ç¼–è¯‘äº§ç‰©è¾“å‡ºå› `projects/cli/assets/js/dist/` (ä¿æŒ CLI èµ„æºå®Œæ•´æ€§)
3. **å®šä½å™¨ä¼˜åŒ–**: `AssetLocator` é‡æ„ä¸ºæŒ‡å‘ `assets` æ ¹ç›®å½•ï¼Œè°ƒç”¨æ–¹æŒ‡å®šç›¸å¯¹è·¯å¾„ `js/dist/xxx`
4. **è·¯å¾„ä¿®å¤**: ä¿®æ­£äº† TS é…ç½®æ–‡ä»¶å¼•ç”¨ï¼Œå¹¶å¯¹é½å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„èµ„æºæŸ¥æ‰¾é€»è¾‘

**æœ€ç»ˆç»“æ„**:
- Src: `projects/cli-js-bridges/config-bridge/`
- Dist: `projects/cli/assets/js/dist/config-bridge.js`
- Install: `~/.cache/novelsaga/assets/<version>/js/dist/config-bridge.js` (è‡ªåŠ¨ä»äºŒè¿›åˆ¶è§£å‹)

**éªŒè¯ç»“æœ**:
- âœ… `build-js` æ­£ç¡®è¾“å‡ºåˆ° assets ç›®å½•
- âœ… å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡
- âœ… Release æ¨¡å¼ä¸‹èµ„æºè‡ªåŠ¨å†…åµŒå¹¶è§£å‹

## ğŸ¯ å†å²å®Œæˆè®°å½•

å®Œæ•´å†å²è®°å½•è¯·å‚è§ï¼š[COMPLETED_TASKS.md](COMPLETED_TASKS.md)

- P1.3 é™æ€é…ç½®æ ¼å¼æ”¯æŒ (Done)
- P1.1.4 æ¸…ç†åºŸå¼ƒæµ‹è¯• (Done)
- P1.1.2 JS Bridge è‡ªåŠ¨æ„å»º (Done)
- P1.1.1 ç”¨æˆ·æŒ‡å®šè¿è¡Œæ—¶ (Done)

---

## ğŸ“… æ¥ä¸‹æ¥çš„å·¥ä½œè®¡åˆ’ (2026-02-03 èµ·)

### ç¬¬ 1 æ­¥ï¼šä»£ç æ¸…ç†ä¸è§„èŒƒåŒ– (P0 å¿…é¡»å®Œæˆ) â­â­â­

**ä»»åŠ¡æ¸…å•**:

1. **Rust ä»£ç æ¸…ç† (Clippy)**:
   - [ ] è¿è¡Œ `cargo clippy --all-targets --all-features` æŸ¥çœ‹æ‰€æœ‰è­¦å‘Š
   - [ ] é€ä¸ªä¿®å¤ `unused imports`, `dead code`, `deprecated` ç­‰è­¦å‘Š
   - [ ] ç¡®ä¿æ‰€æœ‰ crate é€šè¿‡ clippy æ£€æŸ¥

2. **å†—ä½™ä»£ç åˆ é™¤**:
   - [ ] åˆ é™¤ä¸´æ—¶æµ‹è¯•ä»£ç ã€æ³¨é‡Šæ‰çš„åºŸå¼ƒé€»è¾‘
   - [ ] åˆ é™¤æœªä½¿ç”¨çš„å‡½æ•°ã€ç»“æ„ä½“ã€æ¨¡å—

3. **TypeScript/JavaScript ä»£ç è§„èŒƒåŒ–**:
   - [ ] ä¸º `projects/cli-js-bridges` é…ç½® Prettier
   - [ ] é…ç½® ESLint è§„åˆ™
   - [ ] è¿è¡Œæ ¼å¼åŒ–å¹¶ä¿®å¤ lint é”™è¯¯

**è¯´æ˜**: è¿™äº›å±äºä»£ç æ¸…ç†ï¼ˆCode Cleanupï¼‰å’Œè§„èŒƒåŒ–ï¼ˆLintingï¼‰ï¼Œè€Œéé‡æ„ï¼ˆRefactoringï¼‰

### ç¬¬ 2 æ­¥ï¼šé”™è¯¯æ¶ˆæ¯ä¼˜åŒ– (P1 ä¼˜åŒ–ä½“éªŒ)

æ”¹è¿›ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤ºï¼Œä¾‹å¦‚ï¼š

- âŒ å½“å‰: `IO Error`
- âœ… æ”¹è¿›: `æœªæ‰¾åˆ° Node.jsï¼Œè¯·æ£€æŸ¥ PATH æˆ–ä½¿ç”¨ --node-path å‚æ•°`

**é‡ç‚¹æ–‡ä»¶**:

- `projects/cli/src/bridge/error.rs`
- `projects/cli/src/config/error.rs`
- `projects/cli/src/assets/error.rs`

### ç¬¬ 3 æ­¥ï¼šä¸‹ä¸€é˜¶æ®µæ¶æ„åˆ†æ (P2 æ ¸å¿ƒåŠŸèƒ½)

**å†³ç­–ç‚¹**: å…ƒæ•°æ®ç®¡ç†å™¨ (Metadata) vs æ’ä»¶åŠ è½½å™¨ (Plugin Loader)

**åˆ†æ**:

- æ’ä»¶ç³»ç»Ÿå¯èƒ½ä¾èµ–å…ƒæ•°æ®ç»“æ„
- éœ€è¦è¯¦ç»†çš„éœ€æ±‚åˆ†æï¼Œå†³å®šå¹¶è¡Œæˆ–é¡ºåºå¼€å‘

---

## ğŸ“… å·²å®Œæˆçš„é‡Œç¨‹ç¢‘

### âœ… æ„å»ºéªŒè¯ (2026-02-02)

- [x] **Manual Build**: `./xtask.sh build-all` âœ…
- [x] **Nix Build**: `nix build .#bundle` å’Œ `nix build .#cli` âœ…

### âœ… æ„å»ºç³»ç»Ÿé‡æ„ (2026-02-02)

- [x] **Build Tool ç»Ÿä¸€**: åˆ›å»º `@nsaga/build-tool` åŒ… âœ…
- [x] **æ¶ˆé™¤é‡å¤ä»£ç **: 5 ä¸ª bridge æ„å»ºè„šæœ¬é‡æ„å®Œæˆ âœ…
- [x] **æ„å»ºæµ‹è¯•**: `./xtask.sh build-js` éªŒè¯é€šè¿‡ âœ…

### â³ å¾…å®Œæˆï¼šä»£ç æ¸…ç†ä¸è§„èŒƒåŒ–

- [ ] **Rust Clippy**: æ¸…ç†æ‰€æœ‰ clippy è­¦å‘Š
- [ ] **åˆ é™¤å†—ä½™ä»£ç **: ä¸´æ—¶ä»£ç å’Œæœªä½¿ç”¨çš„å®šä¹‰
- [ ] **JS/TS è§„èŒƒåŒ–**: Prettier + ESLint é…ç½®å’Œåº”ç”¨

---

## ğŸ§Š æš‚ç¼“ä»»åŠ¡ (å·²ç§»è‡³ BACKLOG.md)

ä»¥ä¸‹éç´§æ€¥ä»»åŠ¡å·²ç§»å‡ºå½“å‰è¿­ä»£:

- ç¨³å¥æ€§: RPC è¶…æ—¶ã€Bridge å´©æºƒæ—¥å¿—æ”¶é›†
- ä½“éªŒ: é…ç½®çƒ­é‡è½½
- æ€§èƒ½: Bridge é¢„çƒ­ (Warmup)
- è¿ç»´: CI/CD æµæ°´çº¿

---

## ğŸ¯ å†å²å®Œæˆè®°å½•

å®Œæ•´å†å²è®°å½•è¯·å‚è§ï¼š[COMPLETED_TASKS.md](COMPLETED_TASKS.md)

- P1.3 é™æ€é…ç½®æ ¼å¼æ”¯æŒ (Done)
- P1.1.4 æ¸…ç†åºŸå¼ƒæµ‹è¯• (Done)
- P1.1.2 JS Bridge è‡ªåŠ¨æ„å»º (Done)
- P1.1.1 ç”¨æˆ·æŒ‡å®šè¿è¡Œæ—¶ (Done)


### ä»»åŠ¡ 4.1: ç”¨æˆ·æ–‡æ¡£ (3-4h)
**ä½ç½®**: `docs/CONFIG_GUIDE.md`

**å†…å®¹**:
- [ ] é…ç½®æ–‡ä»¶æ ¼å¼å®Œæ•´è¯´æ˜
- [ ] JS/TS é…ç½®ç¤ºä¾‹ï¼ˆé™æ€ vs å‡½æ•°å¼ï¼‰
- [ ] é…ç½®ä¼˜å…ˆçº§è§„åˆ™
- [ ] å¸¸è§é—®é¢˜æ’æŸ¥

### ä»»åŠ¡ 4.2: å¼€å‘è€…æ–‡æ¡£ (2-3h)
**ä½ç½®**: `docs/BRIDGE_DEVELOPMENT.md`

**å†…å®¹**:
- [ ] Bridge æ¶æ„è¯´æ˜
- [ ] å¦‚ä½•æ·»åŠ æ–°çš„ Bridgeï¼ˆplugin-bridge ç¤ºä¾‹ï¼‰
- [ ] è¿è¡Œæ—¶é€‚é…æŒ‡å—
- [ ] è°ƒè¯•æŠ€å·§

---

## â±ï¸ æ—¶é—´é¢„ä¼°æ€»ç»“

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | é¢„ä¼°æ—¶é—´ | æ¨èç¨‹åº¦ |
|--------|------|---------|---------|
| **P1** | ä»£ç è´¨é‡å’Œç¨³å®šæ€§ | **7h** | â­â­â­ å¼ºçƒˆæ¨è |
| P2 | ç¨³å¥æ€§å¢å¼º | 7-10h | â­â­ å»ºè®®åš |
| P3 | æ€§èƒ½ä¼˜åŒ– | 1-2h | â­ å¯é€‰ |
| æ–‡æ¡£ | ç”¨æˆ·+å¼€å‘è€…æ–‡æ¡£ | 5-7h | â­ å¯é€‰ |
| **æ€»è®¡** | | **20-26h** | |

---

## ğŸ¯ æ¨èæ‰§è¡Œé¡ºåº

### ç¬¬ 1 æ­¥ï¼šP1 ä»£ç è´¨é‡ï¼ˆå¿…åšï¼‰
1. ~~**æ¸…ç†è­¦å‘Š**~~ â†’ **å®Œæˆå‰©ä½™æ¸…ç†** (4h) - é›†æˆç”¨æˆ·è·¯å¾„ã€JS è‡ªåŠ¨æ„å»ºã€ç”Ÿäº§ç¯å¢ƒæ”¯æŒ
2. **æ”¹è¿›é”™è¯¯æ¶ˆæ¯** (3h) - æå‡ç”¨æˆ·ä½“éªŒ
3. ~~**é™æ€é…ç½®æ”¯æŒ**~~ âœ… Core å·²å®ç°

**é¢„æœŸæˆæœ**: ç”Ÿäº§å¯ç”¨çš„åŸºç¡€ç‰ˆæœ¬

---

### ç¬¬ 2 æ­¥ï¼šP2 ç¨³å¥æ€§ï¼ˆå»ºè®®åšï¼‰
æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©ï¼š
- å¦‚æœéœ€è¦é•¿æ—¶é—´è¿è¡Œ â†’ ä¼˜å…ˆåš **è¶…æ—¶æœºåˆ¶**
- å¦‚æœç”¨æˆ·åé¦ˆé—®é¢˜éš¾æ’æŸ¥ â†’ ä¼˜å…ˆåš **å´©æºƒæ—¥å¿—**
- å¦‚æœéœ€è¦å¼€å‘æ—¶å¿«é€Ÿè¿­ä»£ â†’ ä¼˜å…ˆåš **çƒ­é‡è½½**

**é¢„æœŸæˆæœ**: ä¼ä¸šçº§ç¨³å®šæ€§

---

### ç¬¬ 3 æ­¥ï¼šP3 æ€§èƒ½ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰
å¦‚æœç”¨æˆ·æŠ±æ€¨å¯åŠ¨æ…¢ â†’ åš **Bridge é¢„çƒ­**
~~é…ç½®ç¼“å­˜~~ â†’ Core å·²å®ç°

**é¢„æœŸæˆæœ**: æè‡´æ€§èƒ½ä½“éªŒ

---

## ğŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨å»ºè®®

**å»ºè®®ä» P1.2 å¼€å§‹**ï¼ˆæ”¹è¿›é”™è¯¯æ¶ˆæ¯ï¼‰ï¼š
- ç”¨æˆ·ä½“éªŒå½±å“æœ€å¤§
- åç»­å¼€å‘å’Œè°ƒè¯•éƒ½ä¼šå—ç›Š
- å®ç°ç›¸å¯¹ç®€å•ï¼Œæˆå°±æ„Ÿå¼º

**ç«‹å³è¡ŒåŠ¨**:
```bash
# æŸ¥çœ‹å½“å‰è­¦å‘Š
cargo check -p novelsaga-cli

# å¼€å§‹æ”¹è¿›é”™è¯¯æ¶ˆæ¯
code projects/cli/src/bridge/error.rs
```

---

## ğŸ¤” éœ€è¦ç¡®è®¤çš„é—®é¢˜

åœ¨å¼€å§‹ä¸‹ä¸€æ­¥å·¥ä½œå‰ï¼Œéœ€è¦æ˜ç¡®ï¼š

1. **ä¼˜å…ˆçº§ç¡®è®¤**ï¼šå…ˆå®Œæˆ P1.1 å‰©ä½™æ¸…ç†ï¼ˆ4hï¼‰è¿˜æ˜¯ç›´æ¥åš P1.2 æ”¹è¿›é”™è¯¯æ¶ˆæ¯ï¼Ÿ
   - P1.1 å‰©ä½™ï¼šæ›´å®ç”¨ï¼Œè§£å†³ç”Ÿäº§éƒ¨ç½²å’Œç”¨æˆ·è‡ªå®šä¹‰è¿è¡Œæ—¶é—®é¢˜
   - P1.2ï¼šæ›´æœ‰æˆå°±æ„Ÿï¼Œç”¨æˆ·ä½“éªŒæå‡æ˜æ˜¾
2. ~~é™æ€é…ç½®~~ï¼šCore å·²å®ç°ï¼Œæ— éœ€é¢å¤–å·¥ä½œ
3. **è¿è¡Œæ—¶é€‰æ‹©**ï¼šé›†æˆ `--runtime`, `--node-path` ç­‰å‚æ•°ï¼ˆP1.1.1 ä¼šå¤„ç†ï¼‰
4. **æ–‡æ¡£éœ€æ±‚**ï¼šæ˜¯å¦éœ€è¦ä¼˜å…ˆç¼–å†™ç”¨æˆ·æ–‡æ¡£ï¼Ÿ

**å»ºè®®**: å…ˆåš P1.1 å‰©ä½™æ¸…ç†ï¼ˆå®ç”¨ä¼˜å…ˆï¼‰ï¼Œå†åš P1.2ï¼ˆä½“éªŒä¼˜åŒ–ï¼‰ğŸš€
